#!name=Netflix GraphQL 拦截
#!desc=拦截并修改 Netflix GraphQL 响应，移除 clcsInterstitialLolomo 和 clcsInterstitialPlaybackV2 字段

[Script]
Netflix GraphQL 拦截 = type=http-response,pattern=^https?://web\.prod\.cloud\.netflix\.com/graphql,requires-body=1,max-size=0,script=function shouldBlock(json) { if (!json || !json.data) return false; return json.data.hasOwnProperty('clcsInterstitialLolomo') || json.data.hasOwnProperty('clcsInterstitialPlaybackV2'); } let body = $response.body; try { const json = JSON.parse(body); if (shouldBlock(json)) { console.log("[Surge] 拦截到包含目标字段的响应，返回空对象"); let headers = {}; if ($response.headers) { for (let key in $response.headers) { headers[key] = $response.headers[key]; } } headers["Content-Type"] = "application/json"; $done({ body: "{}", status: 200, headers: headers }); } else { $done({}); } } catch (e) { console.warn("[Surge] 响应解析错误:", e); $done({}); }

[MITM]
hostname = web.prod.cloud.netflix.com

